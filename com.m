img0 = imread("Image Compression\tim-roosjen-WTSBy0LQOfM-unsplash.jpg");
img1 = imread("rgb.png");
img2 = img0(:,:,1);
img3 = img0(:,:,2);
img5 = img0(:,:,3);
img4 = im2double(img2);

Y = (0.299 * img0(:,:,1))+(0.587 * img0(:,:,2))+(0.114* img0(:,:,3));


Cb = -(0.169 * img0(:,:,1))-(0.311 * img0(:,:,2))+(0.500* img0(:,:,3));


Cr = (0.500 * img0(:,:,1))-(0.419 * img0(:,:,2))-(0.081* img0(:,:,3));

all = img0;
all(:,:,1) = Y;
all(:,:,2) = Cb;
all(:,:,3) = Cr;

imgycbcr = rgb2ycbcr(img0);

% YY = imgycbcr(:,:,1);
% Cb = imgycbcr(:,:,2);
% Cr = imgycbcr(:,:,3);
% 
% all(:,:,1) = YY;
% all(:,:,2) = Cb;
% all(:,:,3) = Cr;
subplot(1,3,1),imshow(Y);

subplot(1,3,2),imshow(Cb);
subplot(1,3,3),imshow(Cr);

all(:,:,1) = Y;
all(:,:,2) = Cb;
all(:,:,3) = Cr;
T = dctmtx(8);
subplot(2,2,1),imshow(T);
%dct = @(block_struct) T * block_struct.data * T';
Y = im2double(Y);
imwrite(Y,"y.jpg");
B = blkproc(Y,[8 8],'P1*x*P2',T,T');
subplot(2,2,2),imshow(B);
mask = [1   1   1   1   1   1   1   1 0   0   0   0  0   0   0   0
        1   1   1   0   0   0   0   0
        1   1   0   0   0   0   0   0
        1   0   0   0   0   0   0   0
        0   0   0   0   0   0   0   0
        0   0   0   0   0   0   0   0
        0   0   0   0   0   0   0   0
        0   0   0   0   0   0   0   0];
B2 = blkproc(B,[8 8],'P1.*x',mask);
I2 = blkproc(B2,[8 8],'P1*x*P2',T',T);
subplot(2,2,3),imshow(B2);
subplot(2,2,4),imshow(I2);
imwrite(I2,"f.jpg");
% T = dctmtx(16);
% B = blkproc(img4,[16 16],'P1*x*P2',T,T');
% 
% mask = [1   1   1   1   1   1   1   1	1   0   0   0   0   0   0   0
%         1   1   1   1	1   1	1   1	0   0   0   0   0   0   0   0
%         1   1   1   1	1   1   1   0	0   0   0   0   0   0   0   0
%         1   1	1   1   1   1   1   0	0   0   0   0   0   0   0   0
%         1   1   1   1   1   1   0   0	0   0   0   0   0   0   0   0
%         1   1   1   1   1   0   0   0	0   0   0   0   0   0   0   0
%         1   1   1   1   0   0   0   0	0   0   0   0   0   0   0   0
%         1   1   1   0   0   0   0   0	0   0   0   0   0   0   0   0
%         1   1   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         1   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0];
% B2 = blkproc(B,[16 16],'P1.*x',mask);
% I2 = blkproc(B2,[16 16],'P1*x*P2',T',T);
% 
% 
% I = img0(:,:,2);
% I = im2double(I);
% T = dctmtx(16);
% B = blkproc(I,[16 16],'P1*x*P2',T,T');
% mask = [1   1   1   1   1   1   1   1	1   0   0   0   0   0   0   0
%         1   1   1   1	1   1	1   1	0   0   0   0   0   0   0   0
%         1   1   1   1	1   1   1   0	0   0   0   0   0   0   0   0
%         1   1	1   1   1   1   1   0	0   0   0   0   0   0   0   0
%         1   1   1   1   1   1   0   0	0   0   0   0   0   0   0   0
%         1   1   1   1   1   0   0   0	0   0   0   0   0   0   0   0
%         1   1   1   1   0   0   0   0	0   0   0   0   0   0   0   0
%         1   1   1   0   0   0   0   0	0   0   0   0   0   0   0   0
%         1   1   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         1   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0];
% B2 = blkproc(B,[16 16],'P1.*x',mask);
% I3 = blkproc(B2,[16 16],'P1*x*P2',T',T);
% 
% 
% I = img0(:,:,3);
% I = im2double(I);
% T = dctmtx(16);
% B = blkproc(I,[16 16],'P1*x*P2',T,T');
% mask = [1   1   1   1   1   1   1   1	1   0   0   0   0   0   0   0
%         1   1   1   1	1   1	1   1	0   0   0   0   0   0   0   0
%         1   1   1   1	1   1   1   0	0   0   0   0   0   0   0   0
%         1   1	1   1   1   1   1   0	0   0   0   0   0   0   0   0
%         1   1   1   1   1   1   0   0	0   0   0   0   0   0   0   0
%         1   1   1   1   1   0   0   0	0   0   0   0   0   0   0   0
%         1   1   1   1   0   0   0   0	0   0   0   0   0   0   0   0
%         1   1   1   0   0   0   0   0	0   0   0   0   0   0   0   0
%         1   1   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         1   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0
%         0   0   0   0   0   0   0   0	0   0   0   0   0   0   0   0];
% B2 = blkproc(B,[16 16],'P1.*x',mask);
% I4 = blkproc(B2,[16 16],'P1*x*P2',T',T);
% 
% 
% L(:,:,:)=cat(3,I2, I3, I4);
% imwrite(L,'CompressedColourImage3.jpg');
% 
% 
% 
% 
% subplot(2,2,1),imshow(L);
% 
% subplot(2,2,2),imshow(img3);
% subplot(2,2,3),imshow(img5);